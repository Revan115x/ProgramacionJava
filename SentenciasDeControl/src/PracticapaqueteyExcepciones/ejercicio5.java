package PracticapaqueteyExcepciones;

import java.time.DateTimeException;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Formatter;
import java.util.InputMismatchException;
import java.util.Scanner;

public class ejercicio5 {

	static Scanner sc;

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		/*
		 * 5. Lee una cadena e intenta extraer una fecha con el formato dd/mm/yyyy de su
		 * contenido (la cadena puede tener otras cosas, por ejemplo “Yo nací el
		 * 29/02/1998”). Los casos en los que no se encuentre ninguna fecha o se
		 * encuentren varias deberán manejarse con excepciones.
		 */

		//variables que utilizare
		boolean correcto = false;
		String nacimiento, posible = null;
		LocalDate fecha;
		DateTimeFormatter patron = DateTimeFormatter.ofPattern("dd/MM/yyyy");

		//llamo el scanner para poder leer desde cualquier lado
		sc = new Scanner(System.in);

		//bucle para validar la fecha
		do {

			//pido la fecha
			System.out.println("QUE DIAS HAS NACIDO?");
			nacimiento = sc.nextLine();

			//intento con un bucle por ir pasando por cada caracter del string
			for (int i = 0; i < nacimiento.length(); i++) {
				//si lee un caracter que es numero para
				if (Character.isDigit(nacimiento.charAt(i))) {
					//cuando detecta solo se queda ese numero, entonces le digo i+10 (10 porque es lo que mide mi patron dd/MM/yyyy )para que pille todo los numeros siguientes y que no se pase de la longitud de la cadena
					if (i + 10 <= nacimiento.length()) {
						//posible es la que almacenara la cadena de numeros que hemos sacado con un substring diciendo que pille i y i le sume 10 para coger todos los numeros
						posible = nacimiento.substring(i, i + 10);
						
						try {
							
							// intento pasar el string a local date + el patron, si es correcto sale del bucle
							fecha = LocalDate.parse(posible, patron);
							System.out.println("LA FECHA ES " + patron.format(fecha));
							correcto = true;
						} catch (DateTimeException e) {//en caso de no ser correcta la fecha del string posible salta esta excepcion
							System.out.println("NO HAY FECHA");
							sc.nextLine();
						} catch (NullPointerException e) {//cuando no detecta nada en general
							System.out.println("AÑADE ALGO");
						}

					}
				}
			}
			
		} while (!correcto);

	}

}
